/* FUENTES Y BASE */
body { font-family: 'Inter', sans-serif; background-color: #f8fafc; color: #1e293b; }

/* SPINNER */
.loader {
    width: 48px; height: 48px;
    border: 4px solid #e2e8f0; border-bottom-color: #4f46e5;
    border-radius: 50%; animation: rotation 1s linear infinite;
}
@keyframes rotation { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }

/* ESTRUCTURA PRINCIPAL */
/* Usamos flex para que el footer no moleste */
.layout-container { display: flex; flex-direction: column; height: 100vh; }

/* GRID DEL HORARIO */
.schedule-grid {
    display: grid;
    grid-template-columns: 60px repeat(5, 1fr); /* Hora más discreta */
    grid-auto-rows: 60px; /* Altura estándar de hora */
    background-color: white;
    border: 1px solid #cbd5e1;
    border-radius: 8px;
    box-shadow: 0 4px 6px -1px rgba(0,0,0,0.05);
    position: relative;
    /* Importante para impresión */
    print-color-adjust: exact; 
    -webkit-print-color-adjust: exact;
}

/* ENCABEZADOS */
.grid-header {
    background-color: #f1f5f9; color: #475569;
    font-weight: 700; font-size: 0.75rem; letter-spacing: 0.05em;
    text-transform: uppercase;
    display: flex; align-items: center; justify-content: center;
    border-bottom: 1px solid #cbd5e1;
    border-right: 1px solid #e2e8f0;
    z-index: 20;
}
.grid-header.sticky { position: sticky; top: 0; z-index: 30; box-shadow: 0 2px 4px rgba(0,0,0,0.05); }

/* CELDAS DE TIEMPO Y DÍAS */
.grid-time-slot {
    background-color: #fff; color: #94a3b8;
    font-size: 0.7rem; font-weight: 600;
    display: flex; align-items: center; justify-content: center;
    border-right: 1px solid #cbd5e1;
    border-bottom: 1px solid #f1f5f9;
}

.grid-cell {
    background-color: white; 
    border-right: 1px solid #f1f5f9; 
    border-bottom: 1px solid #f1f5f9;
    position: relative; 
    transition: background 0.1s;
}
.grid-cell:hover { background-color: #f8fafc; }
/* Feedback visual al arrastrar */
.grid-cell.droppable-hover { background-color: #f0fdf4; box-shadow: inset 0 0 0 2px #22c55e; }

/* TARJETAS DE CLASE (Estables, sin saltos) */
.schedule-item {
    position: absolute;
    padding: 4px 6px;
    border-radius: 4px;
    border-left: 4px solid;
    background: rgba(255, 255, 255, 0.95);
    color: #334155;
    font-size: 0.7rem;
    overflow: hidden;
    cursor: pointer;
    box-shadow: 0 1px 3px rgba(0,0,0,0.1);
    transition: transform 0.1s, box-shadow 0.1s;
    z-index: 10;
    border: 1px solid rgba(0,0,0,0.05);
}

.schedule-item:hover {
    z-index: 50 !important;
    transform: translateY(-1px);
    box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
    background: white;
}

.schedule-item .subject-name {
    font-weight: 700; color: #0f172a;
    white-space: nowrap; overflow: hidden; text-overflow: ellipsis;
    margin-bottom: 1px;
}

.schedule-item .item-details {
    font-size: 0.65rem; color: #64748b; line-height: 1.1;
    white-space: nowrap; overflow: hidden; text-overflow: ellipsis;
}

/* TOOLTIP PERSONALIZADO (Flotante) */
#custom-tooltip {
    position: fixed;
    background: #1e293b; color: white;
    padding: 10px 14px; border-radius: 6px;
    font-size: 0.8rem; line-height: 1.4;
    pointer-events: none; /* El mouse lo atraviesa */
    z-index: 9999;
    box-shadow: 0 10px 15px -3px rgba(0,0,0,0.3);
    opacity: 0; transition: opacity 0.1s;
    transform: translate(10px, 10px); /* Offset del cursor */
    max-width: 250px;
}
#custom-tooltip.visible { opacity: 1; }
#custom-tooltip strong { color: #e2e8f0; display: block; margin-bottom: 2px; font-size: 0.9rem;}
#custom-tooltip .meta { color: #94a3b8; font-size: 0.75rem; margin-top: 6px; border-top: 1px solid #334155; padding-top: 6px;}

/* BOTONES DE ACCIÓN (Solo visibles en hover) */
.schedule-item .actions {
    position: absolute; top: 2px; right: 2px;
    display: none; /* Oculto por defecto */
}
.schedule-item:hover .actions { display: flex; gap: 2px; }
.schedule-item .actions button {
    width: 18px; height: 18px; border-radius: 3px;
    background: #f1f5f9; border: 1px solid #cbd5e1;
    color: #475569; display: flex; align-items: center; justify-content: center;
    cursor: pointer; font-size: 10px;
}
.schedule-item .actions button:hover { background: #ef4444; color: white; border-color: #ef4444; }

/* BLOQUEOS */
.schedule-block {
    position: absolute; z-index: 5;
    background: repeating-linear-gradient(45deg, #f1f5f9, #f1f5f9 10px, #e2e8f0 10px, #e2e8f0 20px);
    border: 1px dashed #cbd5e1;
    display: flex; align-items: center; justify-content: center;
    color: #94a3b8; font-size: 0.7rem; font-weight: 600;
    pointer-events: none; /* No interactuable */
}
.schedule-block button { pointer-events: auto; } /* El botón de borrar sí */

/* ESTILOS DE IMPRESIÓN */
@media print {
    /* Ocultar todo lo que no sea el horario */
    header, nav, aside, .actions, #notification-container, #modal, #custom-tooltip, .filter-select, button {
        display: none !important;
    }
    
    /* Ajustes del contenedor principal */
    body, .layout-container, main, #tab-content-horario, section {
        height: auto !important;
        width: 100% !important;
        overflow: visible !important;
        background: white !important;
        margin: 0 !important; padding: 0 !important;
        display: block !important;
    }
    
    /* Forzar visibilidad del grid */
    #schedule-grid {
        border: 2px solid #000;
        box-shadow: none;
        width: 100%;
    }
    
    /* Asegurar colores en impresión */
    .schedule-item {
        box-shadow: none !important;
        border: 1px solid #ccc !important;
        page-break-inside: avoid;
    }
    
    /* Título para la impresión */
    #schedule-grid::before {
        content: "Reporte de Horarios - IAEV";
        display: block;
        font-size: 18pt; font-weight: bold;
        margin-bottom: 20px; text-align: center;
    }
}

/* UTILS */
.notification {
    background: white; padding: 10px 16px; border-radius: 6px;
    box-shadow: 0 10px 15px -3px rgba(0,0,0,0.1);
    border-left: 4px solid; transform: translateY(20px); opacity: 0;
    transition: all 0.3s; margin-top: 10px; font-weight: 500;
}
.notification.show { transform: translateY(0); opacity: 1; }
.notification.success { border-color: #22c55e; }
.notification.error { border-color: #ef4444; }
.notification.warning { border-color: #f59e0b; }
